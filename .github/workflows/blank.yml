name: Triggered Workflow

on:
  repository_dispatch:
    types: [servicenow-change-approved]

jobs:
  run:
    runs-on: ubuntu-latest
    steps:
      - name: Echo trigger
        run: echo "Triggered by ServiceNow Change Approval"
          echo Add other actions to build,
          echo test, and deploy your project.
      - name: Notify ServiceNow
        run: |
              curl -X POST https://dev252430.service-now.com//api/github_callback/update_ticket \
              -H "Content-Type: application/json" \
              -H "Authorization: Basic ${{ secrets.SERVICENOW_AUTH }}" \
               -d '{
               "change_number": "CHG0030018",
               "status": "Completed"
              }'
